# Containerized JS9 Documentation

This is documentation for running JS9 in a Linux container, for use with Docker, Podman, or other container orchestration systems.

The OCI compliant image generated by the `Containerfile` (AKA `Dockerfile`) contains:

- The official [Debian slim](https://hub.docker.com/_/debian) as a base.
- A small web server (Caddy) for serving static assets of the JS9 application.
- Node.js 20 to run the 'server-side helper'.
- A `supervisord` process to manage the web server and helper.
- The ability to run with a read-only root file system.

Running JS9 in a container essentially sandboxes it, preventing any vulnerabilities from affecting the hosting system. And specifying a read-only root filesystem severely restricts the damage that an attacker can do to the application.

## Building the container image

These instructions use `podman` but Docker should work with minimal changes to the commands.

```
podman build -t js9:latest .
```

This should take several minutes to generate the image initially, but subsequent builds will be faster if most layers of the image are cached.

## Running the container

This is primarily for testing, since it runs the container in the foreground and removes the container when exited.

Use the `-d` parameter to run in the background. Eventually, these instructions will be updated with `docker compose` and other examples.

```
podman run --rm --name js9-test -p 9999:9999 -p 2718:2718 --read-only --tmpfs /app/web/tmp js9:test
```

Note the `--read-only` parameter, which prevents writes to the root filesystem, and the `--tmpfs /app/web/tmp` argument, which sets a temporary filesystem for use by the helper.

## Examining a running container

While the container is running, you can examine it by executing a shell:

```
podman exec -it js9-test /bin/bash
```

The image is minimal, so common commands are missing, but during development `btop` is included for examining running processes.
